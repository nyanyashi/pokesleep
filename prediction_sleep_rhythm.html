<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>ç¡çœ ãƒªã‚ºãƒ äºˆæ¸¬ãƒ„ãƒ¼ãƒ«</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    :root {
      --bg: #f3fbff;
      --text: #2c2c2c;
    }
    @media (prefers-color-scheme: dark) {
      :root {
        --bg: #0a1a28;
        --text: #e0f0ff;
      }
    }
    body {
      font-family: 'Helvetica Neue', sans-serif;
      background-color: var(--bg);
      margin: 0;
      padding: 0;
      color: var(--text);
    }
    header {
      background-color: #cce7ff;
      padding: 1em;
      text-align: center;
      border-bottom: 2px solid #99ccef;
    }
    header h1 {
      margin: 0;
      font-size: 1.8em;
      color: #245d8f;
    }
    section h2 {
      font-size: 1.3em;
      margin: 1em;
      color: #2c6cab;
      border-left: 4px solid #2c6cab;
      padding-left: 0.5em;
    }
    table {
      width: 95%;
      margin: 0 auto;
      border-collapse: collapse;
      background: #fff;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
      border-radius: 8px;
    }
    th, td {
      padding: 0.5em;
      text-align: center;
      border-bottom: 1px solid #ddd;
    }
    th {
      background-color: #e2f0ff;
    }
    input[type="time"] {
      padding: 0.3em;
      width: 85px;
    }
    #stars-summary {
      width: 90%;
      margin: 1em auto;
      font-size: 1em;
    }
    #rank {
      font-size: 2.2em;
      font-weight: bold;
      color: #2970b8;
    }
    #reward, #reward-icon {
      font-size: 1.6em;
    }
    canvas {
      max-width: 90%;
      margin: 2em auto;
      display: block;
    }
    footer {
      text-align: center;
      margin: 2em;
      font-size: 0.9em;
      color: #999;
    }
    @media (prefers-color-scheme: dark) {
      body, table, th, td {
        background-color: #121e2f;
        color: var(--text);
      }
      th {
        background-color: #264c70;
      }
      td:first-child {
        background-color: #1f364e;
      }
      input[type="time"] {
        background-color: #1b2938;
        color: #ffffff;
        border: 1px solid #90caf9;
        border-radius: 4px;
        box-shadow: 0 0 3px rgba(144,202,249,0.6);
      }
    }
    button {
    background-color: #e2f0ff;
    border: 1px solid #99ccef;
    padding: 0.4em 1em;
    border-radius: 5px;
    cursor: pointer;
    }
    button:hover {
    background-color: #d2e8ff;
    }
  </style>
</head>
<body>
  <header>
    <h1>ğŸŒ™ ç¡çœ ãƒªã‚ºãƒ äºˆæ¸¬ãƒ„ãƒ¼ãƒ«</h1>
    <p>å…¥åŠ›æ¸ˆã¿ã®ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ã€æ˜Ÿè©•ä¾¡ãƒ»ãƒªã‚ºãƒ å®‰å®šåº¦ãƒ»ç†æƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’äºˆæ¸¬ã—ã¾ã™</p>
  </header>

  <section>
    <h2>ğŸ“ ç¡çœ ãƒ‡ãƒ¼ã‚¿å…¥åŠ›</h2>
    <table>
      <thead>
        <tr><th>æ›œæ—¥</th><th>â‘ å…¥çœ </th><th>â‘ èµ·åºŠ</th><th>åˆ†çœ </th><th>â‘¡å…¥çœ </th><th>â‘¡èµ·åºŠ</th></tr>
      </thead>
      <tbody>
        <tr><td>æœˆ</td>
          <td><input type="time" name="sleep1_start_mon"></td>
          <td><input type="time" name="sleep1_end_mon"></td>
          <td><input type="checkbox" id="enable2_mon" onchange="toggleSleep2('mon')"></td>
          <td><input type="time" name="sleep2_start_mon" disabled></td>
          <td><input type="time" name="sleep2_end_mon" disabled></td>
        </tr>
        <tr><td>ç«</td>
          <td><input type="time" name="sleep1_start_tue"></td>
          <td><input type="time" name="sleep1_end_tue"></td>
          <td><input type="checkbox" id="enable2_tue" onchange="toggleSleep2('tue')"></td>
          <td><input type="time" name="sleep2_start_tue" disabled></td>
          <td><input type="time" name="sleep2_end_tue" disabled></td>
        </tr>
        <tr><td>æ°´</td>
          <td><input type="time" name="sleep1_start_wed"></td>
          <td><input type="time" name="sleep1_end_wed"></td>
          <td><input type="checkbox" id="enable2_wed" onchange="toggleSleep2('wed')"></td>
          <td><input type="time" name="sleep2_start_wed" disabled></td>
          <td><input type="time" name="sleep2_end_wed" disabled></td>
        </tr>
        <tr><td>æœ¨</td>
          <td><input type="time" name="sleep1_start_thu"></td>
          <td><input type="time" name="sleep1_end_thu"></td>
          <td><input type="checkbox" id="enable2_thu" onchange="toggleSleep2('thu')"></td>
          <td><input type="time" name="sleep2_start_thu" disabled></td>
          <td><input type="time" name="sleep2_end_thu" disabled></td>
        </tr>
        <tr><td>é‡‘</td>
          <td><input type="time" name="sleep1_start_fri"></td>
          <td><input type="time" name="sleep1_end_fri"></td>
          <td><input type="checkbox" id="enable2_fri" onchange="toggleSleep2('fri')"></td>
          <td><input type="time" name="sleep2_start_fri" disabled></td>
          <td><input type="time" name="sleep2_end_fri" disabled></td>
        </tr>
        <tr><td>åœŸ</td>
          <td><input type="time" name="sleep1_start_sat"></td>
          <td><input type="time" name="sleep1_end_sat"></td>
          <td><input type="checkbox" id="enable2_sat" onchange="toggleSleep2('sat')"></td>
          <td><input type="time" name="sleep2_start_sat" disabled></td>
          <td><input type="time" name="sleep2_end_sat" disabled></td>
        </tr>
        <tr><td>æ—¥</td>
          <td><input type="time" name="sleep1_start_sun"></td>
          <td><input type="time" name="sleep1_end_sun"></td>
          <td><input type="checkbox" id="enable2_sun" onchange="toggleSleep2('sun')"></td>
          <td><input type="time" name="sleep2_start_sun" disabled></td>
          <td><input type="time" name="sleep2_end_sun" disabled></td>
        </tr>
      </tbody>
    </table>
  </section>

  <section>
    <h2>ğŸ“Š è©•ä¾¡çµæœ</h2>
    <div id="stars-summary">
    <p>ğŸ– è©•ä¾¡ãƒ©ãƒ³ã‚¯: <span id="rank">-</span></p>
    <p>ğŸ å ±é…¬ã‚¢ã‚¤ãƒ†ãƒ : <span id="reward">-</span> <span id="reward-icon"></span></p>

    <button onclick="toggleDetails()">ï¼‹ è©³ç´°ã‚’è¡¨ç¤º</button>

    <div id="details-block" style="display:none; margin-top:1em;">
        <p>â­ ç¡çœ æ™‚é–“ã®è©•ä¾¡: <span id="sleep-stars">-</span></p>
        <p>â­ ãƒŸãƒƒãƒ‰ã‚¹ãƒªãƒ¼ãƒ—ã‚¿ã‚¤ãƒ ã®è©•ä¾¡: <span id="mid-stars">-</span></p>
        <p>ğŸ•’ å¹³å‡ç¡çœ æ™‚é–“: <span id="avg-sleep-time">-</span></p>
        <p>ğŸ“Š ç¡çœ æ™‚é–“ã®ã°ã‚‰ã¤ã: <span id="std-sleep">-</span></p>
        <p>ğŸ• å¹³å‡ãƒŸãƒƒãƒ‰ã‚¹ãƒªãƒ¼ãƒ—ã‚¿ã‚¤ãƒ : <span id="avg-mid-time">-</span></p>
        <p>ğŸ“Š ãƒŸãƒƒãƒ‰ã‚¹ãƒªãƒ¼ãƒ—ã®ã°ã‚‰ã¤ã: <span id="std-mid">-</span></p>
    </div>
    </div>
  </section>

  <section>
    <h2>ğŸ“ˆ ã‚°ãƒ©ãƒ•è¡¨ç¤º</h2>
    <canvas id="sleepChart"></canvas>
  </section>

  <section>
    <h2>ğŸŒŸ æ¬¡å›ç¡çœ ã®ã‚¢ãƒ‰ãƒã‚¤ã‚¹</h2>
    <div id="next-sleep-advice"></div>
  </section>
  <footer>
    <p>ä½œæˆè€…: Takahashi | GitHubå…¬é–‹äºˆå®š</p>
  </footer>

<script>
const days = ["mon","tue","wed","thu","fri","sat","sun"];
const jpDays = ["æœˆ","ç«","æ°´","æœ¨","é‡‘","åœŸ","æ—¥"];
let chartInstance = null;

function toggleSleep2(day){
  const en = document.getElementById(`enable2_${day}`).checked;
  document.querySelector(`input[name='sleep2_start_${day}']`).disabled = !en;
  document.querySelector(`input[name='sleep2_end_${day}']`).disabled = !en;
  updateResults();
}

function parseTime(t){ if (!t) return null; const [h,m] = t.split(":").map(Number); return new Date(1970,0,1,h,m); }
function timeDiff(s,e){ if (!s || !e) return 0; let d = (e - s)/60000; return d<0 ? d+1440 : d; }

function calculateDailySleep(s1s,s1e,s2s,s2e,en){
  const d1 = timeDiff(parseTime(s1s), parseTime(s1e));
  const d2 = en ? timeDiff(parseTime(s2s), parseTime(s2e)) : 0;
  return Math.min(d1 + d2, 780);
}

function calculateMidSleep(s,e){
  const start = parseTime(s), end = parseTime(e);
  if (!start || !end) return null;
  const smin = start.getHours()*60 + start.getMinutes();
  const dur = timeDiff(start, end);
  return (smin + dur/2) % 1440;
}

function evaluateSleepStars(arr){ if (!arr.length) return 0;
  const avg = arr.reduce((a,b)=>a+b,0)/arr.length;
  const sd  = Math.sqrt(arr.reduce((a,b)=>a+Math.pow(b-avg,2),0)/arr.length);
  if (sd <= 60) return 3; else if (sd <= 90) return 2; else if (sd <= 120) return 1; else return 0;
}

function evaluateMidStars(arr){
  if (!arr.length) return 0;
  const avg = arr.reduce((a,b)=>a+b,0)/arr.length;
  const sd  = Math.sqrt(arr.reduce((a,b)=>a+Math.pow(b-avg,2),0)/arr.length);
  if (sd <= 30) return 3;
  else if (sd <= 60) return 2;
  else if (sd <= 90) return 1;
  else return 0;
}

function evaluateRank(s,m){
  const total = s + m;
  const reward = `ã°ã‚“ã®ã†ã‚¢ãƒ¡S Ã—${Math.max(total,1)}`;
  return { rank: ["F","E","D","C","B","A","S"][total] || "F", reward };
}

function formatTime(mins){
  const h = Math.floor(mins / 60);
  const m = Math.round(mins % 60);
  return `${h}æ™‚é–“${m}åˆ†`;
}

function formatClock(min){ const h = Math.floor(min/60)%24; const m = Math.round(min%60); return `${String(h).padStart(2,"0")}:${String(m).padStart(2,"0")}`; }


function drawChart(sleepTimes, midTimes){
  const ctx = document.getElementById("sleepChart").getContext("2d");
  const data = {
    labels: jpDays,
    datasets: [
      {
        label: "ãƒŸãƒƒãƒ‰ã‚¹ãƒªãƒ¼ãƒ—ï¼ˆæ™‚åˆ»ï¼‰",
        data: midTimes,
        type: "line",
        yAxisID: "yMid",
        order: 2,
        borderColor: "#ff6f61",
        backgroundColor: "#ff6f61",
        borderWidth: 2,
        tension: 0.4,
        pointRadius: 4,
        pointBackgroundColor: "#fff",
        pointBorderColor: "#ff6f61"
      },
      {
        label: "ç¡çœ æ™‚é–“ï¼ˆåˆ†ï¼‰",
        data: sleepTimes,
        type: "bar",
        yAxisID: "ySleep",
        order: 1,
        backgroundColor: "#7fb8ff",
        barThickness: 5 // ã“ã“ã§æ£’ã®å¹…ã‚’èª¿æ•´
      }
    ]
  };

  const config = {
    type: "bar",
    data,
    options: {
      responsive: true,
      plugins: {
        legend: { position: "top" },
        tooltip: {
          callbacks: {
            label: context => {
              const label = context.dataset.label || "";
              const val = context.raw;
              if (context.dataset.yAxisID === "yMid") {
                const h = Math.floor(val / 60) % 24;
                const m = Math.round(val % 60);
                return `${label}: ${String(h).padStart(2,"0")}:${String(m).padStart(2,"0")}`;
              }
              return `${label}: ${val}åˆ†`;
            }
          }
        }
      },
      scales: {
        ySleep: {
          type: "linear",
          position: "left",
          title: { display: true, text: "ç¡çœ æ™‚é–“ï¼ˆåˆ†ï¼‰" },
          min: 0,
          max: 800,
          grid: { drawOnChartArea: true }
        },
        yMid: {
          type: "linear",
          position: "right",
          title: { display: true, text: "ãƒŸãƒƒãƒ‰ã‚¹ãƒªãƒ¼ãƒ—ï¼ˆæ™‚åˆ»ï¼‰" },
          min: 0,
          max: 1440,
          grid: { drawOnChartArea: false },
          ticks: {
            callback: val => {
              const h = Math.floor(val / 60) % 24;
              const m = Math.round(val % 60);
              return `${String(h).padStart(2,"0")}:${String(m).padStart(2,"0")}`;
            },
            stepSize: 120 // 2æ™‚é–“åˆ»ã¿ãªã©è‡ªç”±ã«èª¿æ•´å¯
          }
        }
      }
    }
  };

  if (chartInstance) chartInstance.destroy();
  chartInstance = new Chart(ctx, config);
}

function saveInputs(){
  const data = {};
  document.querySelectorAll("input").forEach(i => {
    data[i.name || i.id] = i.type==="checkbox" ? i.checked : i.value;
  });
  localStorage.setItem("sleepInputs", JSON.stringify(data));
}

function loadInputs(){
  const saved = JSON.parse(localStorage.getItem("sleepInputs") || "{}");
  for (const key in saved){
    const el = document.querySelector(`[name='${key}'], #${key}`);
    if (el){
      if (el.type === "checkbox") el.checked = saved[key];
      else el.value = saved[key];
      if (el.type === "checkbox") toggleSleep2(key.split("_")[1]);
    }
  }
}
function updateResults(){
  const sleepTimes = [], midTimes = [], validDays = [];

  days.forEach(day => {
    const s1s = document.querySelector(`input[name='sleep1_start_${day}']`)?.value;
    const s1e = document.querySelector(`input[name='sleep1_end_${day}']`)?.value;
    const en  = document.getElementById(`enable2_${day}`)?.checked;
    const s2s = document.querySelector(`input[name='sleep2_start_${day}']`)?.value;
    const s2e = document.querySelector(`input[name='sleep2_end_${day}']`)?.value;

    const d1 = timeDiff(parseTime(s1s), parseTime(s1e));
    const d2 = en ? timeDiff(parseTime(s2s), parseTime(s2e)) : 0;
    const totalSleep = calculateDailySleep(s1s, s1e, s2s, s2e, en);

    if (totalSleep > 0) {
      sleepTimes.push(totalSleep);
      validDays.push(day);
    }

    let mid = null;
    if (d1 >= d2 && d1 > 0) mid = calculateMidSleep(s1s, s1e);
    else if (d2 > d1 && d2 > 0) mid = calculateMidSleep(s2s, s2e);
    if (mid !== null) midTimes.push(mid);
  });

  const sleepStars = evaluateSleepStars(sleepTimes);
  const midStars   = evaluateMidStars(midTimes);
  const { rank, reward } = evaluateRank(sleepStars, midStars);

  document.getElementById("sleep-stars").textContent = `${sleepStars} / 3`;
  document.getElementById("mid-stars").textContent   = `${midStars} / 3`;
  document.getElementById("rank").textContent        = rank;
  document.getElementById("reward").textContent      = reward;

  const candyCount = parseInt(reward.match(/Ã—(\d+)/)?.[1]) || 0;
  document.getElementById("reward-icon").textContent = "ğŸ¬".repeat(candyCount);

  const avgSleep = sleepTimes.length ? Math.round(sleepTimes.reduce((a,b)=>a+b,0)/sleepTimes.length) : 0;
  const avgMid   = midTimes.length ? Math.round(midTimes.reduce((a,b)=>a+b,0)/midTimes.length) : 0;
  document.getElementById("avg-sleep-time").textContent = avgSleep ? formatTime(avgSleep) : "-";
  document.getElementById("avg-mid-time").textContent   = avgMid ? formatClock(avgMid) : "-";

    const sleepSD = sleepTimes.length ? Math.round(
    Math.sqrt(sleepTimes.reduce((a,b) => a + Math.pow(b - avgSleep, 2), 0) / sleepTimes.length)
    ) : 0;

    const midSD = midTimes.length ? Math.round(
    Math.sqrt(midTimes.reduce((a,b) => a + Math.pow(b - avgMid, 2), 0) / midTimes.length)
    ) : 0;

    document.getElementById("std-sleep").textContent = sleepSD ? `${sleepSD}åˆ†` : "-";
    document.getElementById("std-mid").textContent   = midSD ? `${midSD}åˆ†` : "-";

  drawChart(sleepTimes, midTimes);
  showAdvice(avgSleep, avgMid, sleepTimes, midTimes);
  saveInputs();
}

function showAdvice(avgSleep, avgMid, sleepTimes, midTimes){
  const advice = document.getElementById("next-sleep-advice");
  advice.innerHTML = "";

  if (!avgSleep || !avgMid) {
    advice.innerHTML = "<p>éå»ã®ãƒ‡ãƒ¼ã‚¿ãŒå°‘ãªã„ãŸã‚ã€ã‚¢ãƒ‰ãƒã‚¤ã‚¹ã¯è¡¨ç¤ºã§ãã¾ã›ã‚“ã€‚</p>";
    return;
  }

  // å†è©•ä¾¡ï¼ˆç¾åœ¨ã®ç¡çœ ãƒ‡ãƒ¼ã‚¿ã«ã‚ˆã‚‹ï¼‰
  const sleepStars = evaluateSleepStars(sleepTimes);
  const midStars   = evaluateMidStars(midTimes);
  const totalStars = sleepStars + midStars;

  const rankMap = ["F", "E", "D", "C", "B", "A", "S"];
  const bestRank = rankMap[Math.max(0, Math.min(totalStars, 7))];

  // æ¡ä»¶ç¯„å›²
  const sleepMin = Math.max(avgSleep - 30, 240);
  const sleepMax = Math.min(avgSleep + 30, 780);
  const midMin   = (avgMid - 30 + 1440) % 1440;
  const midMax   = (avgMid + 30) % 1440;

  // Sç›®æ¨™ã‹ä»£æ›¿ç›®æ¨™ã‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸åˆ‡ã‚Šæ›¿ãˆ
  const goalMessage = totalStars === 6
    ? `<p>ğŸ¯ ç¾åœ¨ã®ç¡çœ ãƒ‘ã‚¿ãƒ¼ãƒ³ã¯å®‰å®šã—ã¦ãŠã‚Šã€<strong>Sãƒ©ãƒ³ã‚¯</strong>ãŒç‹™ãˆã¾ã™ï¼</p>`
    : `<p>ğŸ¯ ç¾åœ¨ã®å‚¾å‘ã§ã¯ <strong>Sãƒ©ãƒ³ã‚¯ã¯å›°é›£</strong>ã§ã™ãŒã€<strong>${bestRank}ãƒ©ãƒ³ã‚¯</strong>ãŒç›®æŒ‡ã›ã¾ã™ï¼</p>`;

  advice.innerHTML += goalMessage;

  advice.innerHTML += `
    <p>æ¬¡å›ã®ç¡çœ ã¯ä»¥ä¸‹ã®æ¡ä»¶ã‚’æº€ãŸã™ã¨ç†æƒ³çš„ã§ã™ï¼š</p>
    <ul>
      <li>ğŸ•’ ç¡çœ æ™‚é–“ï¼š<strong>${formatTime(sleepMin)}ã€œ${formatTime(sleepMax)}</strong></li>
      <li>ğŸ• ãƒŸãƒƒãƒ‰ã‚¹ãƒªãƒ¼ãƒ—ã‚¿ã‚¤ãƒ ï¼š<strong>${formatClock(midMin)}ã€œ${formatClock(midMax)}</strong></li>
    </ul>
  `;

  // é€šå¸¸ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆ3ã¤ï¼‰
  let patterns = "";
  for (const hOffset of [-45, 0, 45]) {
    const mid      = (avgMid + hOffset + 1440) % 1440;
    const sleepDur = avgSleep;
    const start    = (mid - sleepDur / 2 + 1440) % 1440;
    const end      = (mid + sleepDur / 2) % 1440;
    const type     = hOffset < 0 ? "â‘  æ—©å¯ãƒ‘ã‚¿ãƒ¼ãƒ³" : hOffset > 0 ? "â‘¢ é…å¯ãƒ‘ã‚¿ãƒ¼ãƒ³" : "â‘¡ å®‰å®šãƒ‘ã‚¿ãƒ¼ãƒ³";
    patterns += `
      <li><strong>${type}</strong><br>
        å…¥çœ : ${formatClock(start)} / èµ·åºŠ: ${formatClock(end)}<br>
        <span style="color:gray;">ï¼ˆ${formatTime(sleepDur)}ãƒ»ãƒŸãƒƒãƒ‰ã‚¹ãƒªãƒ¼ãƒ— ${formatClock(mid)}ï¼‰</span>
      </li>`;
  }

  advice.innerHTML += `<h3>ğŸ’¤ é€šå¸¸ç¡çœ ã®ææ¡ˆãƒ‘ã‚¿ãƒ¼ãƒ³</h3><ul>${patterns}</ul>`;

  // åˆ†å‰²ç¡çœ ï¼šçŸ­æ™‚é–“é¸æŠï¼‹3ãƒ‘ã‚¿ãƒ¼ãƒ³æç¤º
  const napLength = parseInt(document.getElementById("napLength")?.value || "90");
  let splitPatterns = "";
  for (const hOffset of [-45, 0, 45]) {
    const mid         = (avgMid + hOffset + 1440) % 1440;
    const longDur     = avgSleep - napLength;
    const longStart   = (mid - longDur/2 + 1440) % 1440;
    const longEnd     = (mid + longDur/2) % 1440;
    const napStart    = 13 * 60;
    const napEnd      = napStart + napLength;
    const total       = formatTime(avgSleep);
    const type        = hOffset < 0 ? "â‘  æ—©å¯å‹" : hOffset > 0 ? "â‘¢ é…å¯å‹" : "â‘¡ å®‰å®šå‹";

    splitPatterns += `
      <li><strong>${type}</strong><br>
        é•·æ™‚é–“ç¡çœ : ${formatClock(longStart)}ã€œ${formatClock(longEnd)}<br>
        çŸ­æ™‚é–“ç¡çœ : ${formatClock(napStart)}ã€œ${formatClock(napEnd)}<br>
        <span style="color:gray;">ï¼ˆåˆè¨ˆ ${total}ãƒ»ãƒŸãƒƒãƒ‰ã‚¹ãƒªãƒ¼ãƒ— ${formatClock(mid)}ï¼‰</span>
      </li>`;
  }

  advice.innerHTML += `
    <h3>ğŸŒ› åˆ†å‰²ç¡çœ ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆé¸æŠã•ã‚ŒãŸçŸ­æ™‚é–“ç¡çœ ï¼‰</h3>
    <label for="napLength">çŸ­æ™‚é–“ç¡çœ ã®é•·ã•ï¼š</label>
    <select id="napLength" onchange="updateResults()" style="margin-bottom:1em;">
      ${[90,120,150,180,210,240,270,300,330,360,390,420,450,480].map(v => 
        `<option value="${v}" ${v===napLength?"selected":""}>${formatTime(v)}</option>`
      ).join("")}
    </select>
    <ul>${splitPatterns}</ul>
  `;
}

document.addEventListener("DOMContentLoaded", () => {
  loadInputs();
  document.querySelectorAll("input").forEach(i => {
    i.addEventListener("change", updateResults);
  });
  updateResults();
});

function toggleDetails() {
  const block = document.getElementById("details-block");
  const btn = event.target;
  if (block.style.display === "none") {
    block.style.display = "block";
    btn.textContent = "ï¼ è©³ç´°ã‚’éš ã™";
  } else {
    block.style.display = "none";
    btn.textContent = "ï¼‹ è©³ç´°ã‚’è¡¨ç¤º";
  }
}
</script>
